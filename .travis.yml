language: c

# container boots up faster than legacy; problem is no sudo
sudo: false

matrix:
  include:
   - env: RUN=1 SUFFIX=xz
     os: linux
   - env: RUN=2 SUFFIX=xz
     os: linux
   - env: RUN=3 SUFFIX=xz
     os: linux
   - env: RUN=4 SUFFIX=xz
     os: linux
   - env: RUN=1 SUFFIX=bz2
     os: linux
   - env: RUN=2 SUFFIX=bz2
     os: linux
   - env: RUN=3 SUFFIX=bz2
     os: linux
   - env: RUN=4 SUFFIX=bz2
     os: linux

# Can't use apt plugin because dyn/prof GHC are not whitelisted
# Also, download from Haskell website much faster than Launchpad
# Can't download deb and install manually because dpkg --force-no-root does not work
# bz2/xz comparison: xz 0.81s download, 10.85s unpack
#                    bz2 0.64s download, 33.60s 28.71s unpack!!
# Trivial edit to try again

before_install:
 - mkdir $HOME/usr
 - wget http://downloads.haskell.org/~ghc/7.10.3/ghc-7.10.3b-x86_64-deb7-linux.tar.$SUFFIX
 - tar xf ghc-7.10.3b-x86_64-deb7-linux.tar.$SUFFIX
 - cd ghc-7.10.3*
 - ./configure --prefix=$HOME/usr
 - make install
 - export PATH=$HOME/usr/bin:$PATH

script:
 - ghc --version

notifications:
  irc:
    channels:
      - "chat.freenode.net##haskell-cabal"
  slack: haskell-cabal:sCq6GLfy9N8MJrInosg871n4
